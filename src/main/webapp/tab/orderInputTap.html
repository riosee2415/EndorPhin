<div tabindex="2">
	<table class="table table-hover">
		<tr>
			<th>발주일(*)</th>
			<td><input name="dueDate" type='text' /></td>
			<th>발주내역(*)</th>
			<td><input name="orderList" type='text' /></td>
		</tr>
		<tr>
			<th>부서</th>
			<td><input name="deptCode" type='text' />
				<button class="btn btn-default searchModal" value="0">
					<i class="fa fa-search"></i>
				</button></td>
			<th>담당자</th>
			<td><input name="userId" type='text' />
				<button class="btn btn-default searchModal" value="1">
					<i class="fa fa-search"></i>
				</button></td>
		</tr>
		<tr>
			<th>거래처</th>
			<td><input name="clientname" type='text' />
				<button class="btn btn-default searchModal" value="2">
					<i class="fa fa-search"></i>
				</button></td>
			<th>납기일</th>
			<td><input name="paymentDueDate searchModal" id="dueDatePicker"
				type='text' /></td>
		</tr>
	</table>
</div>
<div>
	<button class="btn btn-default">상품 주문</button>
</div>
<div>
	<table class="table table-hover">
		<thead>
			<tr>
				<th><input type="checkbox" id="checkAll" /></th>
				<th>발주번호</th>
				<th>상품명</th>
				<th>규격</th>
				<th>수량</th>
				<th>단가</th>
				<th>공급가액</th>
			</tr>
		</thead>
		<tbody id="dialogProductTbody">
		</tbody>
	</table>
</div>
<div>
	<button class="btn btn-default">선택 삭제</button>
	<div style='float: right;'>
		<label>공급가액</label> <input name="orderPrice" type='text' /> <label>부가세</label>
		<input name="surtax" type='text' /> <label>합계</label> <input
			type='text' name="totalPrice" />
	</div>
</div>

<!-- second modal (상세 수정 화면) -->
<div class="modal" id="myModal3" data-backdrop="static" tabindex="3"
	aria-hidden="true" style="display: none; z-index: 1080;">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h4 class="modal-title" id="secondModalTitle"></h4>
				<button id="secondUpdClose1" type="button" class="close"
					data-dismiss="modal" aria-hidden="true">×</button>
			</div>
			<div class="container"></div>
			<div class="modal-body">
				<div style="overflow: scroll; width: 450px; height: 200px;">
					<table class="table table-hover">
						<thead>
							<tr>
								<th>항목코드</th>
								<th>항목명</th>
							</tr>
						</thead>
						<tbody id="secondModalUpdTbody">
						</tbody>
					</table>
				</div>
			</div>
			<div class="modal-footer">
				<a href="#" data-dismiss="modal" class="btn" id="secondUpdClose">Close</a>
				<a href="#" class="btn" id="secondModalUpd">수정</a> <a href="#"
					class="btn" id="secondModalDel">삭제</a>
			</div>
		</div>
	</div>
</div>



<script>

$(document).ready(function(){
	surtaxChange();	
	$("#dueDatePicker").datepicker({
			dateFormat: 'yy-mm-dd' //Input Display Format 변경
            ,showOtherMonths: true //빈 공간에 현재월의 앞뒤월의 날짜를 표시
            ,showMonthAfterYear:true //년도 먼저 나오고, 뒤에 월 표시
            ,changeYear: true //콤보박스에서 년 선택 가능
            ,changeMonth: true //콤보박스에서 월 선택 가능                
            ,buttonImage: "http://jqueryui.com/resources/demos/datepicker/images/calendar.gif" //버튼 이미지 경로
            ,buttonImageOnly: true //기본 버튼의 회색 부분을 없애고, 이미지만 보이게 함
            ,buttonText: "선택" //버튼에 마우스 갖다 댔을 때 표시되는 텍스트                
            ,yearSuffix: "년" //달력의 년도 부분 뒤에 붙는 텍스트
            ,monthNamesShort: ['1','2','3','4','5','6','7','8','9','10','11','12'] //달력의 월 부분 텍스트
            ,monthNames: ['1월','2월','3월','4월','5월','6월','7월','8월','9월','10월','11월','12월'] //달력의 월 부분 Tooltip 텍스트
            ,dayNamesMin: ['일','월','화','수','목','금','토'] //달력의 요일 부분 텍스트
            ,dayNames: ['일요일','월요일','화요일','수요일','목요일','금요일','토요일']
	});
	$('#dueDatePicker').datepicker('setDate', 'today');
	$(".searchModal").click(function(index, item){
		var check = $(this).val();
		$.ajax({
			method : "post",
			url : "/orders/selectModal",
			data : {
				check : $(this).val()
			},
			success : function(data) {
				$("#secondModalUpdTbody").html("");
				switch (check) {
					case '0':
						for (var i = 0; i < data.deptList.length; i++) {
							$("#secondModalUpdTbody").append("<tr class=\'selectDept\'>"
							+"<td>"+data.deptList[i].deptCode+"</td>"
							+"<td>"+data.deptList[i].deptName+"</td>"
							+"</tr>");
						}
						break;
					case '1':
						for (var i = 0; i < data.employeeList.length; i++) {
							$("#secondModalUpdTbody").append("<tr class=\'selectEmployee\'>"
							+"<td>"+data.employeeList[i].userId+"</td>"
							+"<td>"+data.employeeList[i].userNm+"</td>"
							+"<tr>");
						}
						break;
					case '2':
						for (var i = 0; i < data.clientList.length; i++) {
							$("#secondModalUpdTbody").append("<tr class=\'selectClient\'>"+
							"<td>"+data.clientList[i].clientCode+"</td>"+
							"<td>"+data.clientList[i].clientName+"</td>"+
							"<tr>");
						}
						break;
				}
				modalClickEvent();
			}
		});
		$("#myModal3").modal('show');
	})
});

function modalClickEvent(){
	$(".selectDept, .selectEmployee, .selectClient").click(function(){
		switch ($(this).attr('class')) {
			case 'selectDept':
				$('input[name=deptCode]').val($(this).find('td').eq(0).html());
				break;
			case 'selectEmployee':
				$('input[name=userId]').val($(this).find('td').eq(0).html());
				break;
			case 'selectClient':
				$('input[name=clientname]').val($(this).find('td').eq(1).html());
				break;
		}
		$("#myModal3").modal('hide');
	});
}
function surtaxChange(){
	$("input[name=orderPrice]").on('change',function(){
       	$("input[name=surtax]").val(parseInt($("input[name=orderPrice]").val())/10);
       	$("input[name=totalPrice]").val(Number($("input[name=surtax]").val())+
       			Number($("input[name=orderPrice]").val()));
	});
}
</script>

